<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="clinicaveterinaria.meupetemdia.controller.RelatoriosController"
            styleClass="root-container"
            prefHeight="768.0"
            prefWidth="1024.0">

    <!-- ========== BARRA SUPERIOR ========== -->
    <top>
        <HBox styleClass="header-bar" alignment="CENTER">
            <padding>
                <Insets top="15" right="30" bottom="15" left="30" />
            </padding>

            <Button fx:id="btnVoltar" text="â† Voltar" styleClass="secondary-button"
                    onAction="#handleVoltar">
                <HBox.margin>
                    <Insets right="20" />
                </HBox.margin>
            </Button>

            <Label fx:id="lblTitulo" text="ðŸ“Š RelatÃ³rios e EstatÃ­sticas" styleClass="app-title">
                <HBox.hgrow>ALWAYS</HBox.hgrow>
            </Label>

            <Button fx:id="btnAtualizar" text="ðŸ”„ Atualizar" styleClass="secondary-button"
                    onAction="#handleAtualizar" />
        </HBox>
    </top>

    <!-- ========== CONTEÃšDO CENTRAL ========== -->
    <center>
        <ScrollPane fx:id="scrollPane" fitToWidth="true" styleClass="root-container">
            <VBox fx:id="vboxPrincipal" spacing="30">
                <padding>
                    <Insets top="30" right="30" bottom="30" left="30" />
                </padding>

                <!-- ========== CARDS DE ESTATÃSTICAS GERAIS ========== -->
                <VBox spacing="15">
                    <Label text="VisÃ£o Geral" styleClass="screen-title" />

                    <GridPane fx:id="gridCards" hgap="20" vgap="20">

                        <!-- Card Total de Pets -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8"
                              GridPane.columnIndex="0" GridPane.rowIndex="0"
                              prefWidth="220" prefHeight="140">
                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20" />
                            </padding>
                            <Label text="ðŸ•" style="-fx-font-size: 36px;" />
                            <Label fx:id="lblTotalPets" text="0" styleClass="screen-title">
                                <font>
                                    <Font size="32" />
                                </font>
                            </Label>
                            <Label text="Pets Cadastrados" styleClass="info-label" />
                        </VBox>

                        <!-- Card Total de Donos -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8"
                              GridPane.columnIndex="1" GridPane.rowIndex="0"
                              prefWidth="220" prefHeight="140">
                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20" />
                            </padding>
                            <Label text="ðŸ‘¤" style="-fx-font-size: 36px;" />
                            <Label fx:id="lblTotalDonos" text="0" styleClass="screen-title">
                                <font>
                                    <Font size="32" />
                                </font>
                            </Label>
                            <Label text="ProprietÃ¡rios" styleClass="info-label" />
                        </VBox>

                        <!-- Card Total de Consultas -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8"
                              GridPane.columnIndex="2" GridPane.rowIndex="0"
                              prefWidth="220" prefHeight="140">
                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20" />
                            </padding>
                            <Label text="ðŸ“‹" style="-fx-font-size: 36px;" />
                            <Label fx:id="lblTotalConsultas" text="0" styleClass="screen-title">
                                <font>
                                    <Font size="32" />
                                </font>
                            </Label>
                            <Label text="Consultas Realizadas" styleClass="info-label" />
                        </VBox>

                        <!-- Card Total de Vacinas -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8"
                              GridPane.columnIndex="3" GridPane.rowIndex="0"
                              prefWidth="220" prefHeight="140">
                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20" />
                            </padding>
                            <Label text="ðŸ’‰" style="-fx-font-size: 36px;" />
                            <Label fx:id="lblTotalVacinas" text="0" styleClass="screen-title">
                                <font>
                                    <Font size="32" />
                                </font>
                            </Label>
                            <Label text="Vacinas Aplicadas" styleClass="info-label" />
                        </VBox>

                    </GridPane>
                </VBox>

                <Separator />

                <!-- ========== GRÃFICOS ========== -->
                <HBox spacing="30" alignment="TOP_CENTER">

                    <!-- GRÃFICO DE PIZZA: STATUS DAS VACINAS -->
                    <VBox spacing="10" alignment="TOP_CENTER" HBox.hgrow="ALWAYS">
                        <Label text="Status das Vacinas dos Pets" styleClass="section-title" />
                        <PieChart fx:id="chartVacinas" styleClass="chart"
                                  prefHeight="350" prefWidth="450"
                                  legendVisible="true" labelsVisible="true" />
                    </VBox>

                </HBox>

                <!-- GRÃFICO DE BARRAS: CONSULTAS POR MÃŠS -->
                <VBox spacing="10" alignment="TOP_CENTER">
                    <Label text="Consultas por MÃªs (Ãšltimos 6 meses)" styleClass="section-title" />
                    <BarChart fx:id="chartConsultas" styleClass="chart"
                              prefHeight="300" animated="false">
                        <xAxis>
                            <CategoryAxis label="MÃªs" />
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Quantidade" />
                        </yAxis>
                    </BarChart>
                </VBox>

                <!-- INFORMAÃ‡Ã•ES ADICIONAIS -->
                <VBox styleClass="card" spacing="10">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20" />
                    </padding>
                    <Label text="â„¹ï¸ InformaÃ§Ãµes" styleClass="section-title" />
                    <Label text="â€¢ Os dados sÃ£o atualizados em tempo real" styleClass="info-label" />
                    <Label text="â€¢ O grÃ¡fico de vacinas mostra apenas pets com vacinas registradas" styleClass="info-label" />
                    <Label text="â€¢ Vacinas vencidas hÃ¡ mais de 30 dias sÃ£o consideradas 'Atrasadas'" styleClass="info-label" />
                    <Label text="â€¢ Consultas sÃ£o contabilizadas pela data de realizaÃ§Ã£o" styleClass="info-label" />
                </VBox>

            </VBox>
        </ScrollPane>
    </center>

</BorderPane>